{"ast":null,"code":"import _taggedTemplateLiteral from \"/Volumes/MyMacDrive128/Python/react-tracks/react-tracks-client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";\nvar _jsxFileName = \"/Volumes/MyMacDrive128/Python/react-tracks/react-tracks-client/src/components/Track/LikeTrack.js\";\n\nfunction _templateObject() {\n  var data = _taggedTemplateLiteral([\"\\n  mutation($trackId: Int!) {\\n    createLike(trackId: $trackId) {\\n      track {\\n        id\\n        likeSet {\\n          id\\n        }\\n      }\\n    }\\n  }\\n\"]);\n\n  _templateObject = function _templateObject() {\n    return data;\n  };\n\n  return data;\n}\n\nimport React, { useContext } from \"react\";\nimport withStyles from \"@material-ui/core/styles/withStyles\";\nimport IconButton from \"@material-ui/core/IconButton\";\nimport ThumbUpIcon from \"@material-ui/icons/ThumbUp\";\nimport { UserContext, ME_QUERY } from '../../Root';\nimport { Mutation } from \"react-apollo\";\nimport { gql } from \"apollo-boost\";\n\nvar LikeTrack = function LikeTrack(_ref) {\n  var classes = _ref.classes,\n      tracks = _ref.tracks,\n      likeCount = _ref.likeCount;\n  var currentUser = useContext(UserContext);\n\n  var handleDisabledLikedTrack = function handleDisabledLikedTrack() {\n    var userLikes = currentUser.likeSet;\n    var isTrackLiked = userLikes.findIndex(function (_ref2) {\n      var tracks = _ref2.tracks;\n      return track.id === tracks.id;\n    }) > -1;\n    return isTrackLiked;\n  };\n\n  return React.createElement(Mutation, {\n    mutation: CREATE_LIKE_MUTATION,\n    variables: {\n      trackId: tracks.id\n    },\n    onCompleted: function onCompleted(data) {\n      console.log(data);\n    },\n    refetchQueries: function refetchQueries() {\n      return [{\n        query: ME_QUERY\n      }];\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 23\n    },\n    __self: this\n  }, function (createLike) {\n    return React.createElement(IconButton, {\n      onClick: function onClick(event) {\n        event.stopPropagation();\n        createLike();\n      },\n      className: classes.iconButton,\n      disabled: handleDisabledLikedTrack(),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 33\n      },\n      __self: this\n    }, likeCount, React.createElement(ThumbUpIcon, {\n      className: classes.icon,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 42\n      },\n      __self: this\n    }));\n  });\n};\n\nvar CREATE_LIKE_MUTATION = gql(_templateObject());\n\nvar styles = function styles(theme) {\n  return {\n    iconButton: {\n      color: \"deeppink\"\n    },\n    icon: {\n      marginLeft: theme.spacing.unit / 2\n    }\n  };\n};\n\nexport default withStyles(styles)(LikeTrack);","map":{"version":3,"sources":["/Volumes/MyMacDrive128/Python/react-tracks/react-tracks-client/src/components/Track/LikeTrack.js"],"names":["React","useContext","withStyles","IconButton","ThumbUpIcon","UserContext","ME_QUERY","Mutation","gql","LikeTrack","classes","tracks","likeCount","currentUser","handleDisabledLikedTrack","userLikes","likeSet","isTrackLiked","findIndex","track","id","CREATE_LIKE_MUTATION","trackId","data","console","log","query","createLike","event","stopPropagation","iconButton","icon","styles","theme","color","marginLeft","spacing","unit"],"mappings":";;;;;;;;;;;;;AAAA,OAAOA,KAAP,IAAiBC,UAAjB,QAAmC,OAAnC;AACA,OAAOC,UAAP,MAAuB,qCAAvB;AACA,OAAOC,UAAP,MAAuB,8BAAvB;AACA,OAAOC,WAAP,MAAwB,4BAAxB;AAEA,SAASC,WAAT,EAAsBC,QAAtB,QAAsC,YAAtC;AACA,SAASC,QAAT,QAAyB,cAAzB;AACA,SAASC,GAAT,QAAoB,cAApB;;AAEA,IAAMC,SAAS,GAAG,SAAZA,SAAY,OAAoC;AAAA,MAAjCC,OAAiC,QAAjCA,OAAiC;AAAA,MAAxBC,MAAwB,QAAxBA,MAAwB;AAAA,MAAhBC,SAAgB,QAAhBA,SAAgB;AAEpD,MAAMC,WAAW,GAAGZ,UAAU,CAACI,WAAD,CAA9B;;AAGA,MAAMS,wBAAwB,GAAG,SAA3BA,wBAA2B,GAAM;AACrC,QAAMC,SAAS,GAAGF,WAAW,CAACG,OAA9B;AACA,QAAMC,YAAY,GAAGF,SAAS,CAACG,SAAV,CAAoB;AAAA,UAAEP,MAAF,SAAEA,MAAF;AAAA,aAAcQ,KAAK,CAACC,EAAN,KAAYT,MAAM,CAACS,EAAjC;AAAA,KAApB,IAA2D,CAAC,CAAjF;AACA,WAAOH,YAAP;AAED,GALD;;AAOA,SACE,oBAAC,QAAD;AACE,IAAA,QAAQ,EAAEI,oBADZ;AAEE,IAAA,SAAS,EAAE;AAAEC,MAAAA,OAAO,EAAEX,MAAM,CAACS;AAAlB,KAFb;AAGE,IAAA,WAAW,EAAE,qBAAAG,IAAI,EAAI;AACnBC,MAAAA,OAAO,CAACC,GAAR,CAAYF,IAAZ;AACD,KALH;AAOE,IAAA,cAAc,EAAI;AAAA,aAAI,CAAC;AAACG,QAAAA,KAAK,EAAEpB;AAAR,OAAD,CAAJ;AAAA,KAPpB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KASG,UAAAqB,UAAU;AAAA,WACT,oBAAC,UAAD;AACE,MAAA,OAAO,EAAE,iBAAAC,KAAK,EAAI;AAChBA,QAAAA,KAAK,CAACC,eAAN;AACAF,QAAAA,UAAU;AACX,OAJH;AAKE,MAAA,SAAS,EAAEjB,OAAO,CAACoB,UALrB;AAME,MAAA,QAAQ,EAAGhB,wBAAwB,EANrC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAQGF,SARH,EASE,oBAAC,WAAD;AAAa,MAAA,SAAS,EAAEF,OAAO,CAACqB,IAAhC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MATF,CADS;AAAA,GATb,CADF;AAyBD,CArCD;;AAuCA,IAAMV,oBAAoB,GAAGb,GAAH,mBAA1B;;AAaA,IAAMwB,MAAM,GAAG,SAATA,MAAS,CAAAC,KAAK;AAAA,SAAK;AACvBH,IAAAA,UAAU,EAAE;AACVI,MAAAA,KAAK,EAAE;AADG,KADW;AAIvBH,IAAAA,IAAI,EAAE;AACJI,MAAAA,UAAU,EAAEF,KAAK,CAACG,OAAN,CAAcC,IAAd,GAAqB;AAD7B;AAJiB,GAAL;AAAA,CAApB;;AASA,eAAenC,UAAU,CAAC8B,MAAD,CAAV,CAAmBvB,SAAnB,CAAf","sourcesContent":["import React , { useContext } from \"react\";\nimport withStyles from \"@material-ui/core/styles/withStyles\";\nimport IconButton from \"@material-ui/core/IconButton\";\nimport ThumbUpIcon from \"@material-ui/icons/ThumbUp\";\n\nimport { UserContext, ME_QUERY } from '../../Root';\nimport { Mutation } from \"react-apollo\";\nimport { gql } from \"apollo-boost\";\n\nconst LikeTrack = ({ classes, tracks, likeCount }) => {\n\n  const currentUser = useContext(UserContext)\n\n\n  const handleDisabledLikedTrack = () => {\n    const userLikes = currentUser.likeSet;\n    const isTrackLiked = userLikes.findIndex(({tracks}) => track.id ===tracks.id) > -1 ;\n    return isTrackLiked;\n\n  }\n\n  return (\n    <Mutation\n      mutation={CREATE_LIKE_MUTATION}\n      variables={{ trackId: tracks.id }}\n      onCompleted={data => {\n        console.log(data);\n      }}\n\n      refetchQueries = {()=>[{query: ME_QUERY }]}\n    >\n      {createLike => (\n        <IconButton\n          onClick={event => {\n            event.stopPropagation();\n            createLike();\n          }}\n          className={classes.iconButton}\n          disabled={(handleDisabledLikedTrack())}\n        >\n          {likeCount}\n          <ThumbUpIcon className={classes.icon} />\n        </IconButton>\n      )}\n    </Mutation>\n  );\n};\n\nconst CREATE_LIKE_MUTATION = gql`\n  mutation($trackId: Int!) {\n    createLike(trackId: $trackId) {\n      track {\n        id\n        likeSet {\n          id\n        }\n      }\n    }\n  }\n`;\n\nconst styles = theme => ({\n  iconButton: {\n    color: \"deeppink\"\n  },\n  icon: {\n    marginLeft: theme.spacing.unit / 2\n  }\n});\n\nexport default withStyles(styles)(LikeTrack);\n"]},"metadata":{},"sourceType":"module"}